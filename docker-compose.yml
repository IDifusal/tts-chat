version: '3.8'

services:
  tts-bot:
    build: .
    container_name: kick-tts-bot
    ports:
      - "8000:8000"
    environment:
      - APP_NAME=Kick TTS Bot
      - DEBUG=true
      - HOST=0.0.0.0
      - PORT=8000
      - KICK_CHANNEL=${KICK_CHANNEL}
      - KICK_WEBSOCKET_URL=wss://ws-us2.pusher.com/app/32cbd69e4b950bf97679
      - PIPER_MODEL=models/es_ES-davefx-medium.onnx
      - PIPER_VOICE=es-spanish-male
      - AUDIO_OUTPUT_DIR=./static/audio
      - SOUNDS_DIR=./static/sounds
      - CACHE_DIR=./static/cache
      - AUDIO_FORMAT=mp3
      - AUDIO_BITRATE=128k
      - ENABLE_REDIS_CACHE=${ENABLE_REDIS_CACHE:-false}
      - REDIS_HOST=redis
      - REDIS_PORT=6379
      - REDIS_DB=0
      - MIN_MESSAGE_LENGTH=2
      - MAX_MESSAGE_LENGTH=200
      - COOLDOWN_SECONDS=1
      - IGNORE_COMMANDS=true
      - ENABLE_TTS=true
      - ENABLE_SOUNDS=true
      - WIDGET_SHOW_MESSAGES=true
      - WIDGET_MESSAGE_DURATION=5000
      - WIDGET_MAX_MESSAGES=3
    volumes:
      - ./static/audio:/app/static/audio
      - ./static/sounds:/app/static/sounds
      - ./static/cache:/app/static/cache
      - ./models:/app/models
    restart: unless-stopped
    depends_on:
      - redis
    networks:
      - tts-network

  redis:
    image: redis:7-alpine
    container_name: kick-tts-redis
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    restart: unless-stopped
    networks:
      - tts-network

volumes:
  redis-data:

networks:
  tts-network:
    driver: bridge
